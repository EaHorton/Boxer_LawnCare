name: Deploy Hugo site to Pagesname: GitHub Pagesname: GitHub Pagesname: GitHub Pagesname: GitHub Pages



on:

  push:

    branches: ["main"]on:

  workflow_dispatch:

  push:

permissions:

  contents: read    branches:on:

  pages: write

  id-token: write      - main



concurrency:  pull_request:  push:

  group: "pages"

  cancel-in-progress: false



defaults:permissions:    branches:on:on:

  run:

    shell: bash  contents: write



jobs:      - main

  build:

    runs-on: ubuntu-latestjobs:

    steps:

      - name: Checkout  deploy:  pull_request:  push:  push:

        uses: actions/checkout@v3

        with:    runs-on: ubuntu-22.04

          submodules: true

          fetch-depth: 0    steps:



      - name: Setup Hugo      - uses: actions/checkout@v3

        uses: peaceiris/actions-hugo@v2

        with:        with:permissions:    branches:    branches:

          hugo-version: '0.152.2'

          extended: true          submodules: true



      - name: Build with Hugo          fetch-depth: 0  contents: write

        run: |

          hugo --minify



      - name: Upload artifact      - name: Setup Hugo      - main  # Set a branch to deploy      - main  # Set a branch to deploy

        uses: actions/upload-pages-artifact@v2

        with:        uses: peaceiris/actions-hugo@v2

          path: ./public

        with:jobs:

  deploy:

    environment:          hugo-version: '0.152.2'

      name: github-pages

      url: ${{ steps.deployment.outputs.page_url }}          extended: true  deploy:  pull_request:  pull_request:

    runs-on: ubuntu-latest

    needs: build

    steps:

      - name: Deploy to GitHub Pages      - name: Build    runs-on: ubuntu-22.04

        id: deployment

        uses: actions/deploy-pages@v2        working-directory: ./

        run: |    concurrency:

          pwd

          hugo --minify      group: ${{ github.workflow }}-${{ github.ref }}



      - name: Deploy    steps:permissions:permissions:

        uses: peaceiris/actions-gh-pages@v3

        if: github.ref == 'refs/heads/main'      - uses: actions/checkout@v3

        with:

          github_token: ${{ secrets.GITHUB_TOKEN }}        with:  contents: write  contents: write

          publish_dir: ./public

          force_orphan: true          submodules: true

          fetch-depth: 0



      - name: Setup Hugojobs:jobs:

        uses: peaceiris/actions-hugo@v2

        with:  deploy:  deploy:

          hugo-version: '0.152.2'

          extended: true    runs-on: ubuntu-22.04    runs-on: ubuntu-22.04



      - name: Build    concurrency:    concurrency:

        run: hugo --minify

      group: ${{ github.workflow }}-${{ github.ref }}      group: ${{ github.workflow }}-${{ github.ref }}

      - name: Deploy

        uses: peaceiris/actions-gh-pages@v3    steps:    steps:

        if: github.ref == 'refs/heads/main'

        with:      - uses: actions/checkout@v3      - uses: actions/checkout@v3

          github_token: ${{ secrets.GITHUB_TOKEN }}

          publish_dir: ./public        with:        with:

          force_orphan: true
          submodules: true  # Fetch Hugo themes (true OR recursive)          submodules: true  # Fetch Hugo themes (true OR recursive)

          fetch-depth: 0    # Fetch all history for .GitInfo and .Lastmod          fetch-depth: 0    # Fetch all history for .GitInfo and .Lastmod



      - name: Setup Hugo      - name: Setup Hugo

        uses: peaceiris/actions-hugo@v2        uses: peaceiris/actions-hugo@v2

        with:        with:

          hugo-version: '0.152.2'          hugo-version: '0.152.2'

          extended: true          extended: true



      - name: Build      - name: Build

        working-directory: ./boxer-lawn-hugo        working-directory: ./boxer-lawn-hugo

        run: hugo --gc --minify        run: hugo --minify



      - name: Deploy      - name: Deploy

        uses: peaceiris/actions-gh-pages@v3        uses: peaceiris/actions-gh-pages@v3

        if: github.ref == 'refs/heads/main'        if: github.ref == 'refs/heads/main'

        with:        with:

          github_token: ${{ secrets.GITHUB_TOKEN }}          github_token: ${{ secrets.GITHUB_TOKEN }}

          publish_dir: ./boxer-lawn-hugo/public          publish_dir: ./public
          force_orphan: true